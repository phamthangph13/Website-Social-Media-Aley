<!DOCTYPE html>
<html lang="vi" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aley - Tin nh·∫Øn</title>
    <link rel="stylesheet" href="Styles/global.css">
    <link rel="stylesheet" href="Styles/messages.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
</head>
<body>
    <div class="container">
        <!-- Thanh ƒëi·ªÅu h∆∞·ªõng - s·∫Ω ƒë∆∞·ª£c load t·ª´ sidebar-menu.html -->
        <div class="sidebar-container"></div>

        <!-- Ph·∫ßn n·ªôi dung ch√≠nh -->
        <main class="main-content">
            <div class="messages-layout">
                <!-- Ph·∫ßn danh s√°ch cu·ªôc tr√≤ chuy·ªán -->
                <div class="conversations-container">
                    <div class="conversations-header">
                        <h1>Tin nh·∫Øn</h1>
                        <div class="conversations-actions">
                            <button class="action-btn" title="T·∫°o cu·ªôc tr√≤ chuy·ªán m·ªõi">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" title="C√†i ƒë·∫∑t tin nh·∫Øn">
                                <i class="fas fa-cog"></i>
                            </button>
                        </div>
                    </div>

                    <div class="search-container">
                        <div class="search-input">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="T√¨m ki·∫øm tin nh·∫Øn...">
                        </div>
                    </div>

                    <div class="conversations-filter">
                        <button class="filter-btn active" data-filter="all">T·∫•t c·∫£</button>
                        <button class="filter-btn" data-filter="unread">Ch∆∞a ƒë·ªçc</button>
                        <button class="filter-btn" data-filter="groups">Nh√≥m</button>
                    </div>

                    <div class="conversations-list">
                        <!-- Cu·ªôc tr√≤ chuy·ªán 1 - ƒêang ho·∫°t ƒë·ªông -->
                        <div class="conversation-card active" data-conversation="conv1">
                            <div class="conversation-avatar">
                                <img src="https://i.pravatar.cc/150?img=32" alt="Avatar">
                                <span class="online-status"></span>
                            </div>
                            <div class="conversation-content">
                                <div class="conversation-info">
                                    <h3>Tr·∫ßn Th·ªã B</h3>
                                    <span class="last-time">12:30</span>
                                </div>
                                <div class="conversation-last-message">
                                    <p>Ch√∫c b·∫°n m·ªôt ng√†y t·ªët l√†nh! üòä</p>
                                    <div class="message-indicators">
                                        <span class="unread-badge">1</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Cu·ªôc tr√≤ chuy·ªán 2 -->
                        <div class="conversation-card" data-conversation="conv2">
                            <div class="conversation-avatar">
                                <img src="https://i.pravatar.cc/150?img=68" alt="Avatar">
                                <span class="offline-status"></span>
                            </div>
                            <div class="conversation-content">
                                <div class="conversation-info">
                                    <h3>L√™ VƒÉn C</h3>
                                    <span class="last-time">H√¥m qua</span>
                                </div>
                                <div class="conversation-last-message">
                                    <p>B·∫°n ƒë√£ xem qua d·ª± √°n m·ªõi ch∆∞a?</p>
                                    <div class="message-indicators">
                                        <span class="unread-badge">2</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Cu·ªôc tr√≤ chuy·ªán 3 -->
                        <div class="conversation-card" data-conversation="conv3">
                            <div class="conversation-avatar group-avatar">
                                <img src="https://i.pravatar.cc/150?img=23" alt="Avatar">
                                <img src="https://i.pravatar.cc/150?img=42" alt="Avatar">
                            </div>
                            <div class="conversation-content">
                                <div class="conversation-info">
                                    <h3>Nh√≥m d·ª± √°n Aley</h3>
                                    <span class="last-time">T2</span>
                                </div>
                                <div class="conversation-last-message">
                                    <p><strong>Ph·∫°m Th·ªã D:</strong> H·ªçp l√∫c 2h chi·ªÅu nh√© m·ªçi ng∆∞·ªùi!</p>
                                    <div class="message-indicators">
                                        <span class="read-status">
                                            <i class="fas fa-check-double"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Cu·ªôc tr√≤ chuy·ªán 4 -->
                        <div class="conversation-card" data-conversation="conv4">
                            <div class="conversation-avatar">
                                <img src="https://i.pravatar.cc/150?img=55" alt="Avatar">
                                <span class="online-status"></span>
                            </div>
                            <div class="conversation-content">
                                <div class="conversation-info">
                                    <h3>Nguy·ªÖn VƒÉn F</h3>
                                    <span class="last-time">T3</span>
                                </div>
                                <div class="conversation-last-message">
                                    <p>C·∫£m ∆°n b·∫°n v·ªÅ nh·ªØng l·ªùi khuy√™n!</p>
                                    <div class="message-indicators">
                                        <span class="read-status">
                                            <i class="fas fa-check-double"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Cu·ªôc tr√≤ chuy·ªán 5 -->
                        <div class="conversation-card" data-conversation="conv5">
                            <div class="conversation-avatar">
                                <img src="https://i.pravatar.cc/150?img=42" alt="Avatar">
                                <span class="offline-status"></span>
                            </div>
                            <div class="conversation-content">
                                <div class="conversation-info">
                                    <h3>Ho√†ng VƒÉn E</h3>
                                    <span class="last-time">25/05</span>
                                </div>
                                <div class="conversation-last-message">
                                    <p>ƒê√£ g·ª≠i file cho b·∫°n r·ªìi nh√©!</p>
                                    <div class="message-indicators">
                                        <span class="read-status">
                                            <i class="fas fa-check-double"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ph·∫ßn n·ªôi dung tin nh·∫Øn -->
                <div class="chat-container">
                    <div class="chat-header">
                        <div class="chat-contact-info">
                            <div class="chat-back-btn">
                                <i class="fas fa-arrow-left"></i>
                            </div>
                            <div class="chat-avatar">
                                <img src="https://i.pravatar.cc/150?img=32" alt="Avatar">
                                <span class="online-status"></span>
                            </div>
                            <div class="chat-name">
                                <h3>Tr·∫ßn Th·ªã B</h3>
                                <span class="status-text">ƒêang ho·∫°t ƒë·ªông</span>
                            </div>
                        </div>
                        <div class="chat-actions">
                            <button class="action-btn" title="G·ªçi tho·∫°i">
                                <i class="fas fa-phone"></i>
                            </button>
                            <button class="action-btn" title="G·ªçi video">
                                <i class="fas fa-video"></i>
                            </button>
                            <button class="action-btn" title="T√πy ch·ªçn">
                                <i class="fas fa-ellipsis-h"></i>
                            </button>
                        </div>
                    </div>

                    <div class="chat-messages">
                        <div class="message-date-separator">
                            <span>H√¥m nay</span>
                        </div>

                        <!-- Tin nh·∫Øn ng∆∞·ªùi kh√°c -->
                        <div class="message their-message">
                            <div class="message-avatar">
                                <img src="https://i.pravatar.cc/150?img=32" alt="Avatar">
                            </div>
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>Ch√†o b·∫°n, b·∫°n kh·ªèe kh√¥ng?</p>
                                </div>
                                <span class="message-time">12:05</span>
                            </div>
                        </div>

                        <!-- Tin nh·∫Øn m√¨nh -->
                        <div class="message my-message">
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>Ch√†o b·∫°n! M√¨nh kh·ªèe, c√≤n b·∫°n th√¨ sao?</p>
                                </div>
                                <span class="message-time">12:07</span>
                            </div>
                        </div>

                        <!-- Tin nh·∫Øn ng∆∞·ªùi kh√°c - nhi·ªÅu tin li√™n ti·∫øp -->
                        <div class="message their-message">
                            <div class="message-avatar">
                                <img src="https://i.pravatar.cc/150?img=32" alt="Avatar">
                            </div>
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>M√¨nh c≈©ng kh·ªèe!</p>
                                </div>
                                <span class="message-time">12:10</span>
                            </div>
                        </div>
                        <div class="message their-message no-avatar">
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>B·∫°n ƒëang l√†m g√¨ v·∫≠y?</p>
                                </div>
                                <span class="message-time">12:10</span>
                            </div>
                        </div>

                        <!-- Tin nh·∫Øn m√¨nh -->
                        <div class="message my-message">
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>M√¨nh ƒëang l√†m vi·ªác v·ªõi d·ª± √°n m·ªõi. C√≤n b·∫°n?</p>
                                </div>
                                <span class="message-time">12:15</span>
                            </div>
                        </div>

                        <!-- Tin nh·∫Øn ng∆∞·ªùi kh√°c - c√≥ h√¨nh ·∫£nh -->
                        <div class="message their-message">
                            <div class="message-avatar">
                                <img src="https://i.pravatar.cc/150?img=32" alt="Avatar">
                            </div>
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>M√¨nh v·ª´a ƒëi d·∫°o ngo√†i c√¥ng vi√™n. Th·ªùi ti·∫øt h√¥m nay ƒë·∫πp l·∫Øm!</p>
                                    <div class="message-image">
                                        <img src="https://source.unsplash.com/random/600x400/?park,nature" alt="H√¨nh ·∫£nh c√¥ng vi√™n">
                                    </div>
                                </div>
                                <span class="message-time">12:25</span>
                            </div>
                        </div>

                        <!-- Tin nh·∫Øn m√¨nh -->
                        <div class="message my-message">
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>Wow, ƒë·∫πp th·∫≠t! Ch√∫c b·∫°n m·ªôt ng√†y t·ªët l√†nh nh√©!</p>
                                </div>
                                <span class="message-time">12:28</span>
                            </div>
                        </div>

                        <!-- Tin nh·∫Øn ng∆∞·ªùi kh√°c - cu·ªëi c√πng -->
                        <div class="message their-message">
                            <div class="message-avatar">
                                <img src="https://i.pravatar.cc/150?img=32" alt="Avatar">
                            </div>
                            <div class="message-content">
                                <div class="message-bubble">
                                    <p>Ch√∫c b·∫°n m·ªôt ng√†y t·ªët l√†nh! üòä</p>
                                </div>
                                <span class="message-time">12:30</span>
                            </div>
                        </div>

                        <!-- Ch·ªâ b√°o ƒëang g√µ -->
                        <div class="typing-indicator">
                            <div class="message-avatar">
                                <img src="https://i.pravatar.cc/150?img=32" alt="Avatar">
                            </div>
                            <div class="message-content">
                                <div class="typing-bubble">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="chat-input-container">
                        <!-- Thanh c√¥ng c·ª• ph∆∞∆°ng ti·ªán -->
                        <div class="media-toolbar">
                            <button class="media-btn" title="G·ª≠i ·∫£nh">
                                <i class="fas fa-image"></i>
                            </button>
                            <button class="media-btn" title="G·ª≠i file">
                                <i class="fas fa-file-alt"></i>
                            </button>
                            <button class="media-btn" title="G·ª≠i GIF">
                                <i class="fas fa-gift"></i>
                            </button>
                            <button class="media-btn" title="Ghi √¢m">
                                <i class="fas fa-microphone"></i>
                            </button>
                            <button class="media-btn" title="V·ªã tr√≠">
                                <i class="fas fa-map-marker-alt"></i>
                            </button>
                        </div>

                        <!-- Thanh nh·∫≠p tin nh·∫Øn ch√≠nh -->
                        <div class="chat-input">
                            <div class="input-attachments">
                                <button class="attach-btn" title="Th√™m t·∫≠p tin ƒë√≠nh k√®m">
                                    <i class="fas fa-paperclip"></i>
                                </button>
                            </div>

                            <div class="message-input">
                                <textarea placeholder="Nh·∫≠p tin nh·∫Øn..." rows="1"></textarea>
                                <div class="message-formatting">
                                    <button class="format-btn" title="ƒê·ªãnh d·∫°ng ch·ªØ">
                                        <i class="fas fa-bold"></i>
                                    </button>
                                    <button class="format-btn" title="Ch√®n m√£">
                                        <i class="fas fa-code"></i>
                                    </button>
                                    <button class="format-btn" title="T·∫°o danh s√°ch">
                                        <i class="fas fa-list"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="input-actions">
                                <div class="emoji-picker-container">
                                    <button class="emoji-btn" title="Ch·ªçn emoji">
                                        <i class="far fa-smile"></i>
                                    </button>
                                    <div class="emoji-picker">
                                        <div class="emoji-categories">
                                            <button class="emoji-category active" data-category="recent">
                                                <i class="fas fa-clock"></i>
                                            </button>
                                            <button class="emoji-category" data-category="smileys">
                                                <i class="far fa-smile"></i>
                                            </button>
                                            <button class="emoji-category" data-category="animals">
                                                <i class="fas fa-paw"></i>
                                            </button>
                                            <button class="emoji-category" data-category="food">
                                                <i class="fas fa-utensils"></i>
                                            </button>
                                            <button class="emoji-category" data-category="activities">
                                                <i class="fas fa-futbol"></i>
                                            </button>
                                            <button class="emoji-category" data-category="travel">
                                                <i class="fas fa-car"></i>
                                            </button>
                                            <button class="emoji-category" data-category="objects">
                                                <i class="fas fa-lightbulb"></i>
                                            </button>
                                            <button class="emoji-category" data-category="symbols">
                                                <i class="fas fa-hashtag"></i>
                                            </button>
                                        </div>
                                        <div class="emoji-list">
                                            <span class="emoji-item">üòÄ</span>
                                            <span class="emoji-item">üòÅ</span>
                                            <span class="emoji-item">üòÇ</span>
                                            <span class="emoji-item">ü§£</span>
                                            <span class="emoji-item">üòÉ</span>
                                            <span class="emoji-item">üòÑ</span>
                                            <span class="emoji-item">üòÖ</span>
                                            <span class="emoji-item">üòÜ</span>
                                            <span class="emoji-item">üòâ</span>
                                            <span class="emoji-item">üòä</span>
                                            <span class="emoji-item">üòã</span>
                                            <span class="emoji-item">üòé</span>
                                            <span class="emoji-item">üòç</span>
                                            <span class="emoji-item">üòò</span>
                                            <span class="emoji-item">ü•∞</span>
                                            <span class="emoji-item">üòó</span>
                                            <span class="emoji-item">üòô</span>
                                            <span class="emoji-item">ü•≤</span>
                                            <span class="emoji-item">üòö</span>
                                            <span class="emoji-item">üôÇ</span>
                                            <span class="emoji-item">ü§ó</span>
                                            <span class="emoji-item">ü§©</span>
                                            <span class="emoji-item">ü§î</span>
                                            <span class="emoji-item">ü´°</span>
                                            <span class="emoji-item">ü§®</span>
                                            <span class="emoji-item">üòê</span>
                                            <span class="emoji-item">üòë</span>
                                        </div>
                                        <div class="emoji-search">
                                            <div class="search-input">
                                                <i class="fas fa-search"></i>
                                                <input type="text" placeholder="T√¨m emoji...">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button class="voice-btn" title="Ghi √¢m tin nh·∫Øn">
                                    <i class="fas fa-microphone"></i>
                                </button>
                                <button class="send-btn" title="G·ª≠i tin nh·∫Øn">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Ph·∫ßn th√¥ng tin chi ti·∫øt b√™n ph·∫£i -->
                <div class="chat-details">
                    <div class="details-header">
                        <h3>Th√¥ng tin</h3>
                        <button class="close-details-btn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="contact-profile">
                        <div class="profile-avatar">
                            <img src="https://i.pravatar.cc/150?img=32" alt="Avatar">
                        </div>
                        <h2>Tr·∫ßn Th·ªã B</h2>
                        <p>@tranthib</p>
                        <div class="contact-actions">
                            <button class="profile-btn">
                                <i class="fas fa-user"></i>
                                <span>Xem h·ªì s∆°</span>
                            </button>
                            <button class="mute-btn">
                                <i class="fas fa-bell-slash"></i>
                                <span>T·∫Øt th√¥ng b√°o</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="shared-content">
                        <div class="content-section">
                            <h4>·∫¢nh ƒë√£ chia s·∫ª</h4>
                            <div class="shared-gallery">
                                <img src="https://source.unsplash.com/random/100x100/?park" alt="·∫¢nh ƒë√£ chia s·∫ª">
                                <img src="https://source.unsplash.com/random/100x100/?city" alt="·∫¢nh ƒë√£ chia s·∫ª">
                                <img src="https://source.unsplash.com/random/100x100/?food" alt="·∫¢nh ƒë√£ chia s·∫ª">
                                <img src="https://source.unsplash.com/random/100x100/?event" alt="·∫¢nh ƒë√£ chia s·∫ª">
                                <a href="#" class="more-media">+8 n·ªØa</a>
                            </div>
                        </div>
                        
                        <div class="content-section">
                            <h4>File ƒë√£ chia s·∫ª</h4>
                            <div class="shared-files">
                                <div class="file-item">
                                    <i class="fas fa-file-pdf"></i>
                                    <div class="file-info">
                                        <p>Project_Proposal.pdf</p>
                                        <span>24/05/2023</span>
                                    </div>
                                    <button class="download-btn">
                                        <i class="fas fa-download"></i>
                                    </button>
                                </div>
                                <div class="file-item">
                                    <i class="fas fa-file-word"></i>
                                    <div class="file-info">
                                        <p>Meeting_Notes.docx</p>
                                        <span>22/05/2023</span>
                                    </div>
                                    <button class="download-btn">
                                        <i class="fas fa-download"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="privacy-options">
                        <div class="option-item">
                            <i class="fas fa-lock"></i>
                            <div class="option-info">
                                <h4>Quy·ªÅn ri√™ng t∆∞</h4>
                                <p>Tin nh·∫Øn ƒë∆∞·ª£c m√£ h√≥a ƒë·∫ßu cu·ªëi</p>
                            </div>
                        </div>
                        <div class="option-item">
                            <i class="fas fa-trash"></i>
                            <div class="option-info">
                                <h4>X√≥a cu·ªôc tr√≤ chuy·ªán</h4>
                                <p>Kh√¥ng th·ªÉ ph·ª•c h·ªìi sau khi x√≥a</p>
                            </div>
                        </div>
                        <div class="option-item">
                            <i class="fas fa-ban"></i>
                            <div class="option-info">
                                <h4>Ch·∫∑n li√™n h·ªá</h4>
                                <p>H·ªç s·∫Ω kh√¥ng th·ªÉ li√™n h·ªá v·ªõi b·∫°n</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Ph·∫ßn b√™n ph·∫£i - s·∫Ω ƒë∆∞·ª£c load t·ª´ right-sidebar.html (·∫©n ·ªü trang tin nh·∫Øn) -->
        <div class="right-sidebar-container hidden"></div>
    </div>

    <!-- Javascript -->
    <script src="../Scripts/api-service.js"></script>
    <script src="../Scripts/auth-guard.js"></script>
    <script src="../Scripts/sidebar-loader.js"></script>
    <script src="../Scripts/right-sidebar-loader.js"></script>
    <script src="../Scripts/page-transition.js"></script>
    <script>
        // Script kh·ªüi t·∫°o m·∫∑c ƒë·ªãnh - ƒë·∫£m b·∫£o khung chat hi·ªÉn th·ªã 
        window.addEventListener('DOMContentLoaded', function() {
            // L·∫•y ph·∫ßn t·ª≠ khung chat
            const chatContainer = document.querySelector('.chat-container');
            
            // L·∫•y danh s√°ch c√°c cu·ªôc tr√≤ chuy·ªán
            const conversations = document.querySelectorAll('.conversation-card');
            
            // N·∫øu c√≥ √≠t nh·∫•t m·ªôt cu·ªôc tr√≤ chuy·ªán v√† ng∆∞·ªùi d√πng ƒëang ·ªü desktop, hi·ªÉn th·ªã chat m·∫∑c ƒë·ªãnh
            if (conversations.length > 0 && window.innerWidth >= 768) {
                // ƒê√°nh d·∫•u cu·ªôc tr√≤ chuy·ªán ƒë·∫ßu ti√™n l√† active
                conversations[0].classList.add('active');
                
                // Hi·ªÉn th·ªã khung chat
                chatContainer.classList.add('active');
                
                // T·∫£i n·ªôi dung cu·ªôc tr√≤ chuy·ªán ƒë·∫ßu ti√™n
                const contactName = conversations[0].querySelector('.conversation-info h3').textContent;
                document.querySelector('.chat-header .chat-name h3').textContent = contactName;
                
                // Cu·ªôn xu·ªëng tin nh·∫Øn cu·ªëi c√πng
                const chatMessages = document.querySelector('.chat-messages');
                if (chatMessages) chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // ƒê√°nh d·∫•u menu tin nh·∫Øn l√† active trong sidebar
            setTimeout(function() {
                const messagesMenuItem = document.querySelector('.sidebar-menu li[data-page="messages"]');
                if (messagesMenuItem) {
                    // X√≥a active t·ª´ t·∫•t c·∫£ c√°c menu item
                    const allMenuItems = document.querySelectorAll('.sidebar-menu li');
                    allMenuItems.forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Th√™m active cho menu tin nh·∫Øn
                    messagesMenuItem.classList.add('active');
                }
            }, 300); // ƒê·ª£i sidebar ƒë∆∞·ª£c t·∫£i xong
            
            // X·ª≠ l√Ω c√°c s·ª± ki·ªán
            setupEventHandlers();
        });
        
        function setupEventHandlers() {
            // C√°c ph·∫ßn t·ª≠ trong trang
            const conversationCards = document.querySelectorAll('.conversation-card');
            const chatContainer = document.querySelector('.chat-container');
            const closeDetailsBtn = document.querySelector('.close-details-btn');
            const infoBtn = document.querySelector('.chat-actions .action-btn:last-child');
            const backBtn = document.querySelector('.chat-back-btn');
            
            // X·ª≠ l√Ω click v√†o cu·ªôc tr√≤ chuy·ªán
            conversationCards.forEach(card => {
                card.addEventListener('click', function() {
                    // Lo·∫°i b·ªè active t·ª´ t·∫•t c·∫£ c√°c cu·ªôc tr√≤ chuy·ªán
                    conversationCards.forEach(c => c.classList.remove('active'));
                    
                    // Th√™m active cho cu·ªôc tr√≤ chuy·ªán ƒë∆∞·ª£c click
                    this.classList.add('active');
                    
                    // Hi·ªÉn th·ªã khung chat (ƒë·∫∑c bi·ªát quan tr·ªçng tr√™n mobile)
                    chatContainer.classList.add('active');
                    
                    // Hi·ªÉn th·ªã t√™n ng∆∞·ªùi ƒëang chat trong header
                    const contactName = this.querySelector('.conversation-info h3').textContent;
                    document.querySelector('.chat-header .chat-name h3').textContent = contactName;
                    
                    // Cu·ªôn xu·ªëng tin nh·∫Øn cu·ªëi c√πng
                    const chatMessages = document.querySelector('.chat-messages');
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    
                    // ƒê√°nh d·∫•u tin nh·∫Øn ƒë√£ ƒë·ªçc n·∫øu c√≥
                    const unreadBadge = this.querySelector('.unread-badge');
                    if (unreadBadge) {
                        unreadBadge.style.display = 'none';
                    }
                });
            });
            
            // X·ª≠ l√Ω n√∫t quay l·∫°i tr√™n mobile
            if (backBtn) {
                backBtn.addEventListener('click', function() {
                    chatContainer.classList.remove('active');
                });
            }
            
            // Hi·ªÉn th·ªã/·∫©n th√¥ng tin chi ti·∫øt
            if (infoBtn) {
                infoBtn.addEventListener('click', function() {
                    document.querySelector('.chat-details').classList.toggle('active');
                });
            }
            
            if (closeDetailsBtn) {
                closeDetailsBtn.addEventListener('click', function() {
                    document.querySelector('.chat-details').classList.remove('active');
                });
            }
            
            // X·ª≠ l√Ω l·ªçc tin nh·∫Øn
            const filterButtons = document.querySelectorAll('.filter-btn');
            
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Lo·∫°i b·ªè active t·ª´ t·∫•t c·∫£ c√°c n√∫t
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Th√™m active cho n√∫t ƒë∆∞·ª£c click
                    this.classList.add('active');
                    
                    // Th√™m l·ªçc th·ª±c t·∫ø ·ªü ƒë√¢y (gi·∫£ l·∫≠p trong demo)
                    const filter = this.getAttribute('data-filter');
                    
                    if (filter === 'unread') {
                        // V√≠ d·ª•: ch·ªâ hi·ªÉn th·ªã c√°c cu·ªôc tr√≤ chuy·ªán c√≥ .unread-badge
                        conversationCards.forEach(card => {
                            if (card.querySelector('.unread-badge')) {
                                card.style.display = 'flex';
                            } else {
                                card.style.display = 'none';
                            }
                        });
                    } else if (filter === 'groups') {
                        // V√≠ d·ª•: ch·ªâ hi·ªÉn th·ªã c√°c cu·ªôc tr√≤ chuy·ªán nh√≥m
                        conversationCards.forEach(card => {
                            if (card.querySelector('.group-avatar')) {
                                card.style.display = 'flex';
                            } else {
                                card.style.display = 'none';
                            }
                        });
                    } else {
                        // Hi·ªÉn th·ªã t·∫•t c·∫£
                        conversationCards.forEach(card => {
                            card.style.display = 'flex';
                        });
                    }
                });
            });
            
            // X·ª≠ l√Ω g·ª≠i tin nh·∫Øn
            setupMessageSending();
        }
        
        function setupMessageSending() {
            const messageInput = document.querySelector('.message-input textarea');
            const sendBtn = document.querySelector('.send-btn');
            
            if (!messageInput || !sendBtn) return;
            
            function sendMessage() {
                const message = messageInput.value.trim();
                
                if (message) {
                    // Th√™m tin nh·∫Øn m·ªõi v√†o cu·ªôc tr√≤ chuy·ªán
                    const chatMessages = document.querySelector('.chat-messages');
                    const newMessage = document.createElement('div');
                    newMessage.classList.add('message', 'my-message', 'animate__animated', 'animate__fadeIn');
                    
                    const currentTime = new Date();
                    const hours = currentTime.getHours().toString().padStart(2, '0');
                    const minutes = currentTime.getMinutes().toString().padStart(2, '0');
                    
                    newMessage.innerHTML = `
                        <div class="message-content">
                            <div class="message-bubble">
                                <p>${message}</p>
                            </div>
                            <span class="message-time">${hours}:${minutes}</span>
                        </div>
                    `;
                    
                    // Th√™m tin nh·∫Øn v√†o cu·ªëi
                    chatMessages.appendChild(newMessage);
                    
                    // X√≥a n·ªôi dung input
                    messageInput.value = '';
                    // Reset chi·ªÅu cao textarea
                    messageInput.style.height = 'auto';
                    
                    // Cu·ªôn xu·ªëng d∆∞·ªõi c√πng
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    
                    // Gi·∫£ l·∫≠p ph·∫£n h·ªìi sau 1 gi√¢y
                    setTimeout(() => {
                        const typingIndicator = document.querySelector('.typing-indicator');
                        typingIndicator.style.display = 'flex';
                        
                        setTimeout(() => {
                            // ·∫®n ch·ªâ b√°o ƒëang g√µ
                            typingIndicator.style.display = 'none';
                            
                            // Th√™m ph·∫£n h·ªìi t·ª± ƒë·ªông
                            const autoReply = document.createElement('div');
                            autoReply.classList.add('message', 'their-message', 'animate__animated', 'animate__fadeIn');
                            
                            const replyTime = new Date();
                            const replyHours = replyTime.getHours().toString().padStart(2, '0');
                            const replyMinutes = replyTime.getMinutes().toString().padStart(2, '0');
                            
                            autoReply.innerHTML = `
                                <div class="message-avatar">
                                    <img src="https://i.pravatar.cc/150?img=32" alt="Avatar">
                                </div>
                                <div class="message-content">
                                    <div class="message-bubble">
                                        <p>C·∫£m ∆°n b·∫°n ƒë√£ nh·∫Øn tin! üëç</p>
                                    </div>
                                    <span class="message-time">${replyHours}:${replyMinutes}</span>
                                </div>
                            `;
                            
                            chatMessages.appendChild(autoReply);
                            chatMessages.scrollTop = chatMessages.scrollHeight;
                        }, 2000);
                    }, 1000);
                }
            }
            
            // X·ª≠ l√Ω s·ª± ki·ªán click n√∫t g·ª≠i
            sendBtn.addEventListener('click', sendMessage);
            
            // X·ª≠ l√Ω s·ª± ki·ªán nh·∫•n Enter ƒë·ªÉ g·ª≠i
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault(); // NgƒÉn kh√¥ng cho xu·ªëng d√≤ng
                    sendMessage();
                }
            });
            
            // Hi·ªÉn th·ªã hi·ªáu ·ª©ng ƒëang g√µ khi focus v√†o input
            messageInput.addEventListener('focus', function() {
                // Hi·ªÉn th·ªã ch·ªâ b√°o ƒëang g√µ ng·∫´u nhi√™n ƒë·ªÉ demo
                if (Math.random() > 0.5) {
                    document.querySelector('.typing-indicator').style.display = 'flex';
                    
                    setTimeout(() => {
                        document.querySelector('.typing-indicator').style.display = 'none';
                    }, 3000);
                }
            });
            
            // T·ª± ƒë·ªông m·ªü r·ªông textarea khi nh·∫≠p
            messageInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
                
                // N·∫øu chi·ªÅu cao v∆∞·ª£t qu√° gi·ªõi h·∫°n, th√™m thanh cu·ªôn
                if (this.scrollHeight > 120) {
                    this.style.overflowY = 'auto';
                } else {
                    this.style.overflowY = 'hidden';
                }
            });
            
            // X·ª≠ l√Ω t√≠nh nƒÉng kh√°c
            setupEmojiPicker();
            setupVoiceMessages();
            setupMediaButtons();
        }
        
        function setupEmojiPicker() {
            const messageInput = document.querySelector('.message-input textarea');
            const emojiItems = document.querySelectorAll('.emoji-item');
            
            if (!messageInput || !emojiItems.length) return;
            
            emojiItems.forEach(emoji => {
                emoji.addEventListener('click', function() {
                    // Th√™m emoji v√†o v·ªã tr√≠ con tr·ªè
                    const startPos = messageInput.selectionStart;
                    const endPos = messageInput.selectionEnd;
                    const text = messageInput.value;
                    const emojiChar = this.textContent;
                    
                    messageInput.value = text.substring(0, startPos) + emojiChar + text.substring(endPos);
                    
                    // ƒê·∫∑t l·∫°i v·ªã tr√≠ con tr·ªè
                    messageInput.selectionStart = messageInput.selectionEnd = startPos + emojiChar.length;
                    messageInput.focus();
                    
                    // K√≠ch ho·∫°t s·ª± ki·ªán input ƒë·ªÉ c·∫≠p nh·∫≠t chi·ªÅu cao
                    const event = new Event('input');
                    messageInput.dispatchEvent(event);
                });
            });
            
            // X·ª≠ l√Ω t√¨m ki·∫øm emoji
            const emojiSearchInput = document.querySelector('.emoji-search input');
            
            if (emojiSearchInput) {
                emojiSearchInput.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    
                    emojiItems.forEach(emoji => {
                        // ƒê∆°n gi·∫£n h√≥a: N·∫øu emoji ch·ª©a t·ª´ kh√≥a (s·∫Ω c·∫ßn c·∫£i thi·ªán trong th·ª±c t·∫ø)
                        if (searchTerm === '' || emoji.getAttribute('data-keyword')?.toLowerCase().includes(searchTerm)) {
                            emoji.style.display = 'flex';
                        } else {
                            emoji.style.display = 'none';
                        }
                    });
                });
            }
            
            // X·ª≠ l√Ω chuy·ªÉn ƒë·ªïi danh m·ª•c emoji
            const emojiCategories = document.querySelectorAll('.emoji-category');
            
            emojiCategories.forEach(category => {
                category.addEventListener('click', function() {
                    // Lo·∫°i b·ªè active t·ª´ t·∫•t c·∫£ c√°c danh m·ª•c
                    emojiCategories.forEach(cat => cat.classList.remove('active'));
                    
                    // Th√™m active cho danh m·ª•c ƒë∆∞·ª£c click
                    this.classList.add('active');
                    
                    // L·ªçc emoji theo danh m·ª•c (gi·∫£ l·∫≠p trong demo)
                    const categoryName = this.getAttribute('data-category');
                    console.log(`ƒê√£ ch·ªçn danh m·ª•c emoji: ${categoryName}`);
                });
            });
        }
        
        function setupVoiceMessages() {
            const messageInput = document.querySelector('.message-input textarea');
            const voiceBtn = document.querySelector('.voice-btn');
            
            if (!voiceBtn || !messageInput) return;
            
            let isRecording = false;
            let recordingStartTime;
            let recordingTimer;
            
            voiceBtn.addEventListener('click', function() {
                if (!isRecording) {
                    // B·∫Øt ƒë·∫ßu ghi √¢m
                    startRecording();
                } else {
                    // D·ª´ng ghi √¢m
                    stopRecording();
                }
            });
            
            function startRecording() {
                console.log('B·∫Øt ƒë·∫ßu ghi √¢m...');
                isRecording = true;
                
                // Thay ƒë·ªïi icon
                voiceBtn.innerHTML = '<i class="fas fa-stop"></i>';
                voiceBtn.style.color = 'var(--danger-color)';
                
                // Th√™m ch·ªâ b√°o ƒëang ghi √¢m
                const messageInputElement = document.querySelector('.message-input');
                
                // T·∫°o ch·ªâ b√°o ghi √¢m n·∫øu ch∆∞a c√≥
                if (!document.querySelector('.recording-indicator')) {
                    const recordingIndicator = document.createElement('div');
                    recordingIndicator.classList.add('recording-indicator');
                    recordingIndicator.innerHTML = `
                        <div class="recording-pulse"></div>
                        <span class="recording-time">00:00</span>
                        <div class="recording-controls">
                            <button class="recording-btn stop" title="H·ªßy">
                                <i class="fas fa-times"></i>
                            </button>
                            <button class="recording-btn send" title="G·ª≠i">
                                <i class="fas fa-check"></i>
                            </button>
                        </div>
                    `;
                    messageInputElement.appendChild(recordingIndicator);
                    
                    // Th√™m s·ª± ki·ªán cho c√°c n√∫t ƒëi·ªÅu khi·ªÉn
                    const stopBtn = recordingIndicator.querySelector('.recording-btn.stop');
                    const sendBtn = recordingIndicator.querySelector('.recording-btn.send');
                    
                    stopBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        cancelRecording();
                    });
                    
                    sendBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        sendVoiceMessage();
                    });
                }
                
                // Hi·ªÉn th·ªã ch·ªâ b√°o
                const recordingIndicator = document.querySelector('.recording-indicator');
                recordingIndicator.classList.add('active');
                
                // B·∫Øt ƒë·∫ßu t√≠nh th·ªùi gian
                recordingStartTime = new Date();
                updateRecordingTime();
                
                // ·∫®n c√°c n√∫t kh√°c
                messageInput.disabled = true;
            }
            
            function updateRecordingTime() {
                const recordingTimeElement = document.querySelector('.recording-time');
                if (!recordingTimeElement) return;
                
                const currentTime = new Date();
                const elapsedSeconds = Math.floor((currentTime - recordingStartTime) / 1000);
                const minutes = Math.floor(elapsedSeconds / 60).toString().padStart(2, '0');
                const seconds = (elapsedSeconds % 60).toString().padStart(2, '0');
                
                recordingTimeElement.textContent = `${minutes}:${seconds}`;
                
                recordingTimer = setTimeout(updateRecordingTime, 1000);
            }
            
            function stopRecording() {
                console.log('D·ª´ng ghi √¢m.');
                isRecording = false;
                
                // Kh√¥i ph·ª•c icon
                voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                voiceBtn.style.color = '';
                
                // ·∫®n ch·ªâ b√°o
                const recordingIndicator = document.querySelector('.recording-indicator');
                if (recordingIndicator) {
                    recordingIndicator.classList.remove('active');
                }
                
                // D·ª´ng c·∫≠p nh·∫≠t th·ªùi gian
                clearTimeout(recordingTimer);
                
                // K√≠ch ho·∫°t l·∫°i c√°c n√∫t kh√°c
                messageInput.disabled = false;
            }
            
            function cancelRecording() {
                console.log('H·ªßy ghi √¢m.');
                stopRecording();
            }
            
            function sendVoiceMessage() {
                console.log('G·ª≠i tin nh·∫Øn tho·∫°i.');
                stopRecording();
                
                // Th√™m tin nh·∫Øn tho·∫°i gi·∫£ l·∫≠p v√†o cu·ªôc tr√≤ chuy·ªán
                const chatMessages = document.querySelector('.chat-messages');
                const newMessage = document.createElement('div');
                newMessage.classList.add('message', 'my-message', 'animate__animated', 'animate__fadeIn');
                
                const currentTime = new Date();
                const hours = currentTime.getHours().toString().padStart(2, '0');
                const minutes = currentTime.getMinutes().toString().padStart(2, '0');
                
                // T√≠nh t·ªïng th·ªùi gian b·∫£n ghi
                const elapsedSeconds = Math.floor((currentTime - recordingStartTime) / 1000);
                const recordMinutes = Math.floor(elapsedSeconds / 60).toString().padStart(2, '0');
                const recordSeconds = (elapsedSeconds % 60).toString().padStart(2, '0');
                
                newMessage.innerHTML = `
                    <div class="message-content">
                        <div class="message-bubble">
                            <div class="voice-message">
                                <button class="voice-play-btn">
                                    <i class="fas fa-play"></i>
                                </button>
                                <div class="voice-waveform"></div>
                                <span class="voice-duration">${recordMinutes}:${recordSeconds}</span>
                            </div>
                        </div>
                        <span class="message-time">${hours}:${minutes}</span>
                    </div>
                `;
                
                chatMessages.appendChild(newMessage);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }
        
        function setupMediaButtons() {
            const mediaButtons = document.querySelectorAll('.media-btn');
            
            mediaButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const type = this.getAttribute('title');
                    console.log(`Ch·ª©c nƒÉng "${type}" ƒë∆∞·ª£c k√≠ch ho·∫°t`);
                    
                    // Gi·∫£ l·∫≠p h√†nh ƒë·ªông d·ª±a tr√™n lo·∫°i n√∫t
                    switch (type) {
                        case 'G·ª≠i ·∫£nh':
                            simulateSendImage();
                            break;
                        case 'G·ª≠i file':
                            // M·ªü h·ªôp tho·∫°i ch·ªçn file
                            break;
                        case 'G·ª≠i GIF':
                            // M·ªü b·ªô ch·ªçn GIF
                            break;
                        case 'Ghi √¢m':
                            // ƒê√£ x·ª≠ l√Ω b·ªüi n√∫t ghi √¢m
                            break;
                    }
                });
            });
            
            function simulateSendImage() {
                // Gi·∫£ l·∫≠p g·ª≠i ·∫£nh t·ª´ th∆∞ vi·ªán
                const chatMessages = document.querySelector('.chat-messages');
                const newMessage = document.createElement('div');
                newMessage.classList.add('message', 'my-message', 'animate__animated', 'animate__fadeIn');
                
                const currentTime = new Date();
                const hours = currentTime.getHours().toString().padStart(2, '0');
                const minutes = currentTime.getMinutes().toString().padStart(2, '0');
                
                newMessage.innerHTML = `
                    <div class="message-content">
                        <div class="message-bubble">
                            <div class="message-image">
                                <img src="https://source.unsplash.com/random/600x400/?nature" alt="H√¨nh ·∫£nh ƒë√£ g·ª≠i">
                            </div>
                        </div>
                        <span class="message-time">${hours}:${minutes}</span>
                    </div>
                `;
                
                chatMessages.appendChild(newMessage);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }
    </script>
</body>
</html> 